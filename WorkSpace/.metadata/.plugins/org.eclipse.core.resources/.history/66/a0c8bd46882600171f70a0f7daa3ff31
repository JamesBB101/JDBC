package com.iii.bb101.james_homework;

import java.io.BufferedReader;
import java.io.FileReader;
import java.io.IOException;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.SQLException;

public class HW_2 {
	public static void main(String[] args) throws IOException {

		String connUrl = "jdbc:mysql://localhost:3306/jdbc?useSSL=false";
		try (Connection conn = DriverManager.getConnection(connUrl, "root", "abcdggd123");) {

			String insStmt = "INSERT INTO employee VALIES(?, ?, ?, ?, ?, ?)";
			PreparedStatement pstmt = conn.prepareStatement(insStmt);

			String path = "./emp.txt";
			BufferedReader br = new BufferedReader(new FileReader(path));
			String row;
			while ((row = br.readLine()) != null) {
				System.out.println(row);
				String[] row_array = row.split(",");
//				for(String r:row_array){
//					System.out.println(r);
//					System.out.println(row_array.length);
//				}
				for (int i = 0; i < row_array.length-1; i++) {
					pstmt.setXInt((i + 1), row_array[i]);
					pstmt.addBatch();
				}
			}
			pstmt.executeBatch();
		} catch (SQLException e) {
			e.printStackTrace();
		}
	}
}
